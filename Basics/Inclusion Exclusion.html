<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en"><head><!-- base href="http://e-maxx.ru/algo/inclusion_exclusion_principle" -->
<script src="Inclusion%20Exclusion_files/tr_page.js" type="text/javascript"></script>
<script src="Inclusion%20Exclusion_files/tr_page_worker.js" type="text/javascript"></script>
<script type="text/javascript">
            (function (win, doc, namespace) {
                var HOST = 'https://z5h64q92x9.net',
                    LINK = doc.createElement('a'),
                    ORIGINAL_URL = win.decodeURIComponent('http%3A//e-maxx.ru/algo/inclusion_exclusion_principle');
                namespace.trDir = 'ru-en';
                namespace.config = {
                    srv: 'tr-url',
                    sid: '0a81055e.565bd7fb.e7fac602',
                    url: 'https://translate.yandex.net/api/v1/tr.json/translate',
                    timeout: 10000,
                    autoSync: true,
                    maxPortionLength: 600
                };
                var isValidPort = function (port) {
                    return !port || port === '80' || port === '443';
                };
                var isValidHref = function (href) {
                    LINK.href = href;
                    return href.indexOf('http') === 0 && isValidPort(LINK.port);
                };
                var getClosest = function (element, predicate) {
                    while (element) {
                        if (predicate(element)) {
                            return element;
                        }
                        element = element.parentNode;
                    }
                    return null;
                };
                var replaceDir = function (href) {
                    var path = href.slice(HOST.length).split('/'),
                        lang = path[2].split('.');

                    if (lang[0] !== namespace.trDir) {
                        lang[0] = namespace.trDir;
                        path[2] = lang.join('.');
                        href = HOST + path.join('/');
                    }

                    return href;
                };
                var createLink = function (href) {
                    href = href.split('://');
                    return [
                        HOST + '/',
                        'proxy_u/',
                        namespace.trDir + '.en/',
                        href[0] + '/',
                        href[1]
                    ].join('');
                };
                var rewriteLink = function (event) {
                    var href,
                        form,
                        link,
                        formAction,
                        formActionAttr = 'action',
                        formTargetAttr = 'target',
                        target = event.target;

                    if (target.form) {
                        form = target.form;
                        if (target.hasAttribute('formaction')) {
                            form = target;
                            formActionAttr = 'formaction';
                            formTargetAttr = 'formtarget';
                        }
                    } else {
                        form = getClosest(target, function (element) {
                            return element.nodeName === 'FORM';
                        });
                    }
                    if (form) {
                        formAction = form.getAttribute(formActionAttr);
                        if (!formAction) {
                            formAction = ORIGINAL_URL;
                            form.setAttribute(formActionAttr, formAction);
                        } else {
                            LINK.href = formAction;
                            formAction = LINK.href;
                        }
                        if (formAction.indexOf(HOST) === 0) {
                            href = replaceDir(formAction);
                            if (href !== formAction) {
                                form.setAttribute(formActionAttr, href);
                            }
                        } else if (isValidHref(formAction)) {
                            if (formAction.indexOf('https') === 0) {
                                form.setAttribute(formTargetAttr, '_top');
                            } else {
                                form.setAttribute(formActionAttr, createLink(formAction));
                            }
                        }
                    }
                    link = getClosest(target, function (element) {
                        return element.nodeName === 'A' ||
                               element.nodeName === 'AREA';
                    });
                    if (!link || !link.href) {
                        return;
                    }
                    if (link.target && link.target !== '_self') {
                        link.target = '_self';
                    }
                    if (link.href.indexOf(HOST) === 0) {
                        href = replaceDir(link.href);
                        if (href !== link.href) {
                            link.href = href;
                        }
                    } else if (isValidHref(link.href)) {
                        link.href = createLink(link.href);
                    }
                };
                // TODO: move to "worker"
                doc.addEventListener('focus', rewriteLink, true);
                doc.addEventListener('mouseover', rewriteLink, false);

                if (win.parent !== win) {
                    namespace.worker.initialize({
                        lang: 'ru',
                        originalUrl: ORIGINAL_URL
                    });
                }
            })(this, this.document, this.yt = this.yt || {});
        </script>
<title>MAXimal :: algo :: the Principle of inclusions-exceptions</title><meta content="text/html; charset=UTF-8" http-equiv="Content-Type"><meta content="e-maxx" name="author" lang="en"><meta content="Algorithms, programming programming, mathematics" name="description"><meta content="алгоритмы программирование" name="keywords"><link href="Inclusion%20Exclusion_files/style.css" rel="stylesheet" type="text/css"><script src="Inclusion%20Exclusion_files/jquery.js" type="text/javascript"></script><script src="Inclusion%20Exclusion_files/page-contents.js" type="text/javascript"></script><link href="Inclusion%20Exclusion_files/geshi.css" rel="stylesheet" type="text/css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--><script src="Inclusion%20Exclusion_files/embed.js" async="" type="text/javascript"></script></head><body><table class="main" cellpadding="0" cellspacing="0"><tbody><tr><td class="title" colspan="2"><p>MAXimal</p></td></tr><tr><td class="menu"><ul><li><a href="https://z5h64q92x9.net/proxy_u/ru-en.en/e-maxx.ru/index.php">home</a></li><li><a class="current" href="https://z5h64q92x9.net/proxy_u/ru-en.en/e-maxx.ru/algo/">algo</a></li><li><a href="https://z5h64q92x9.net/proxy_u/ru-en.en/e-maxx.ru/bookz/">bookz</a></li><li><a href="https://z5h64q92x9.net/proxy_u/ru-en.en/e-maxx.ru/forum/">forum</a></li><li><a href="https://z5h64q92x9.net/proxy_u/ru-en.en/e-maxx.ru/about.php">about</a></li></ul></td><td class="content"><p class="algoinfo">date added: 25 Aug 2011 13:55<br>edited: 22 Oct 2011 19:29</p><div id="contents-table"><p id="contents-table-title">Contents <a href="https://z5h64q92x9.net/proxy_u/ru-en.en/e-maxx.ru/algo/inclusion_exclusion_principle" id="contents-hide">[hide]</a><a href="https://z5h64q92x9.net/proxy_u/ru-en.en/e-maxx.ru/algo/inclusion_exclusion_principle" id="contents-show" style="display:none">[show]</a></p><div style="display:none"></div></div><h1> The principle of inclusions-exceptions </h1><p>The
 principle of inclusions-exceptions is an important combinatorial way to
 calculate the size of any set or calculate the probability of complex 
events.</p><p></p><p></p><h2 style="padding-top:40px;"> The wording of the principle of inclusions-exceptions </h2><p></p><p></p><h3 style="padding-top:15px;"> The verbal formula </h3><p>The principle of inclusions-exclusions as follows:</p><p>To calculate the size of join multiple sets, it is necessary to sum the sizes of these sets <b>individually</b>, then subtract the sizes of all <b>pairwise</b> intersections of these sets, to add back the sizes of intersections of all possible <b>triples</b> of sets, subtract the sizes of the intersections <b>of quadruples</b>, and so on, up to the intersection <b>of all</b> sets.</p><p></p><p></p><h3 style="padding-top:15px;"> The formulation in terms of sets </h3><p>In mathematical form the above verbal formulation is as follows:</p><p></p><p class="formula"><img alt=" \left| \bigcup_{i=1}^n A_i \right| = \sum_{i=1}^n[...]" class="tex" src="Inclusion%20Exclusion_files/e696420a8116535a4b352a0b61e01453.png"></p><p>It can be written more compactly, using the sum of the subsets. We denote <img alt="B" class="tex" src="Inclusion%20Exclusion_files/fb8234db4e6ea317a7c2aef7a38775ba.png"> the set whose elements are <img alt="A_i" class="tex" src="Inclusion%20Exclusion_files/ecd1f057d6ceb5ed438e560f05b03792.png">. Then the principle of inclusions-exceptions takes the form:</p><p></p><p class="formula"><img alt=" \left| \bigcup_{i=1}^n A_i \right| = \sum_{C \sub[...]" class="tex" src="Inclusion%20Exclusion_files/ec86fdd894a6ded309930d92a4f84115.png"></p><p>This formula is attributed to a de Moivre (Abraham de Moivre).</p><p></p><p></p><h3 style="padding-top:15px;"> The formulation with the help of Venn diagrams </h3><p>Let the diagram marked with three figures <img alt="A" class="tex" src="Inclusion%20Exclusion_files/b5f17df636a8bd667d2f5c3404ed82e7.png">, <img alt="B" class="tex" src="Inclusion%20Exclusion_files/fb8234db4e6ea317a7c2aef7a38775ba.png"> and <img alt="C" class="tex" src="Inclusion%20Exclusion_files/5572481c8713abb69ad4011419e91fc7.png">:</p><p><img src="Inclusion%20Exclusion_files/inclusion_exclusion_1.png"></p><p>Then the area of their Union <img alt="A \cup B \cup C" class="tex" src="Inclusion%20Exclusion_files/b8fcb60b1387674c76a26ecaed83724a.png"> is equal to the sum of squares <img alt="A" class="tex" src="Inclusion%20Exclusion_files/b5f17df636a8bd667d2f5c3404ed82e7.png">, <img alt="B" class="tex" src="Inclusion%20Exclusion_files/fb8234db4e6ea317a7c2aef7a38775ba.png"> and <img alt="C" class="tex" src="Inclusion%20Exclusion_files/5572481c8713abb69ad4011419e91fc7.png"> less double-covered areas <img alt="A \cap B" class="tex" src="Inclusion%20Exclusion_files/11c68ccabc979c93e819864daab28321.png">, <img alt="A \cap C" class="tex" src="Inclusion%20Exclusion_files/b811bcc1149e5660851967dd73a4244a.png">, <img alt="B \cap C" class="tex" src="Inclusion%20Exclusion_files/d94a4dac54e5c8d4bfbd7579cdb113ff.png">, but with the addition of three covered area <img alt="A \cap B \cap C" class="tex" src="Inclusion%20Exclusion_files/957067d0217942770b250ce452cafd9b.png">:</p><p></p><p class="formula"><img alt=" S(A \cup B \cup C) = S(A) ~ + ~ S(B) ~ + ~ S(C) ~[...]" class="tex" src="Inclusion%20Exclusion_files/6f95b39af202303960aedbf44d61ce8a.png"></p><p>Similarly, it is generalized and Association <img alt="n" class="tex" src="Inclusion%20Exclusion_files/8bc19c5640342f9c5ad0ba16baf59981.png"> figures.</p><p></p><p></p><h3 style="padding-top:15px;"> The formulation in terms of probability theory </h3><p>If <img alt="A_i" class="tex" src="Inclusion%20Exclusion_files/ecd1f057d6ceb5ed438e560f05b03792.png"> <img alt="(i = 1 \ldots n)" class="tex" src="Inclusion%20Exclusion_files/c2c54841f66706685faa5312c5af0244.png"> are events, <img alt="{\cal P}(A_i)" class="tex" src="Inclusion%20Exclusion_files/972aca823dcc059c29a3519521a3dad2.png"> their probabilities, the probability of their Association (i.e., what will happen to at least one of these events) is:</p><p></p><p class="formula"><img alt="\begin{eqnarray}
{\cal P} \left( \bigcup_{i=1}^n[...]" class="tex" src="Inclusion%20Exclusion_files/645e0aee5498b62735a33d4188f2c21c.png"></p><p>This sum can also be written as the sum of the subsets of a set <img alt="B" class="tex" src="Inclusion%20Exclusion_files/fb8234db4e6ea317a7c2aef7a38775ba.png">whose elements are the events <img alt="A_i" class="tex" src="Inclusion%20Exclusion_files/ecd1f057d6ceb5ed438e560f05b03792.png">:</p><p></p><p class="formula"><img alt=" {\cal P} \left( \bigcup_{i=1}^n A_i \right) = \su[...]" class="tex" src="Inclusion%20Exclusion_files/bb8ce5abf08005a95817ac66243a99c9.png"></p><p></p><p></p><h2 style="padding-top:40px;"> Proof of principle of inclusions-exceptions </h2><p>For the proof it is convenient to use the mathematical formulation in terms of set theory:</p><p></p><p class="formula"><img alt=" \left| \bigcup_{i=1}^n A_i \right| = \sum_{C \sub[...]" class="tex" src="Inclusion%20Exclusion_files/1574a45fe7fd862200e4144ac97d0192.png"></p><p>where <img alt="B" class="tex" src="Inclusion%20Exclusion_files/fb8234db4e6ea317a7c2aef7a38775ba.png">, we recall, is a set consisting of a <img alt="A_i" class="tex" src="Inclusion%20Exclusion_files/ecd1f057d6ceb5ed438e560f05b03792.png">'s.</p><p>We need to prove that any element contained in at least one of the sets <img alt="A_i" class="tex" src="Inclusion%20Exclusion_files/ecd1f057d6ceb5ed438e560f05b03792.png">, will allow for a formula exactly once. (Note that other elements not contained in any <img alt="A_i" class="tex" src="Inclusion%20Exclusion_files/ecd1f057d6ceb5ed438e560f05b03792.png">, can not be considered as absent on the right side of the formula).</p><p>Consider an arbitrary element is <img alt="x" class="tex" src="Inclusion%20Exclusion_files/4a9252cee23f1a80a4e03256ef62d733.png">contained in exactly one <img alt="k \ge 1" class="tex" src="Inclusion%20Exclusion_files/8ceda01123621f3345ced346ee36db0f.png"> set <img alt="A_i" class="tex" src="Inclusion%20Exclusion_files/ecd1f057d6ceb5ed438e560f05b03792.png">. We will show that it will be calculated by the formula exactly once.</p><p>Note that:</p><p></p><ul><p></p><li>in those terms, in which <img alt="size(C) = 1" class="tex" src="Inclusion%20Exclusion_files/ff0ba3dff3603f519905b70bb68c88c9.png">, the item <img alt="x" class="tex" src="Inclusion%20Exclusion_files/4a9252cee23f1a80a4e03256ef62d733.png"> will be counted exactly <img alt="k" class="tex" src="Inclusion%20Exclusion_files/252410059470b019db6fd4c3b844a348.png"> once, with a plus sign;<p></p></li><li>in those terms, in which <img alt="size(C) = 2" class="tex" src="Inclusion%20Exclusion_files/5aac9ee28495bc275d4d446fb07caa35.png">, the item <img alt="x" class="tex" src="Inclusion%20Exclusion_files/4a9252cee23f1a80a4e03256ef62d733.png"> will be taken into account (with a minus sign) exactly <img alt="C_k^2" class="tex" src="Inclusion%20Exclusion_files/99eb1c3df10223934d04a6a73554300b.png"> once — because <img alt="x" class="tex" src="Inclusion%20Exclusion_files/4a9252cee23f1a80a4e03256ef62d733.png"> it is counted only in those terms which correspond to two sets of <img alt="k" class="tex" src="Inclusion%20Exclusion_files/252410059470b019db6fd4c3b844a348.png"> sets containing <img alt="x" class="tex" src="Inclusion%20Exclusion_files/4a9252cee23f1a80a4e03256ef62d733.png">;<p></p></li><li>in those terms, in which <img alt="size(C) = 3" class="tex" src="Inclusion%20Exclusion_files/b15a366848d0759d96046a1de9711d35.png">, the item <img alt="x" class="tex" src="Inclusion%20Exclusion_files/4a9252cee23f1a80a4e03256ef62d733.png"> will be counted exactly <img alt="C_k^3" class="tex" src="Inclusion%20Exclusion_files/7144759a8c8f9205f922ddafa2866531.png"> once, with a plus sign;<p></p></li><li><img alt="\ldots" class="tex" src="Inclusion%20Exclusion_files/267994e119a8959ca9fc503a1ebd7490.png"><p></p></li><li>in those terms, in which <img alt="size(C) = k" class="tex" src="Inclusion%20Exclusion_files/e0006ae94d9885a7adde8828694c1a56.png">, the item <img alt="x" class="tex" src="Inclusion%20Exclusion_files/4a9252cee23f1a80a4e03256ef62d733.png"> will be counted exactly <img alt="C_k^k" class="tex" src="Inclusion%20Exclusion_files/2698587b1d1f071485ff9146dc67f8c7.png"> once, with the sign <img alt="(-1)^{k-1}" class="tex" src="Inclusion%20Exclusion_files/be0e5be4e2487a5699fcc4604d8d6ad0.png">;<p></p></li><li>in those terms, in which <img alt="size(C) &gt; k" class="tex" src="Inclusion%20Exclusion_files/470a023081a98bf38bf1a803b15bf4d5.png">, the item <img alt="x" class="tex" src="Inclusion%20Exclusion_files/4a9252cee23f1a80a4e03256ef62d733.png"> will be counted zero times.<p></p></li></ul><p>Thus, we need to calculate a sum <a href="https://z5h64q92x9.net/proxy_u/ru-en.en/e-maxx.ru/algo/binomial_coeff">of binomial coefficients</a>:</p><p></p><p class="formula"><img alt=" T = C_k^1 - C_k^2 + C_k^3 - \ldots + (-1)^{i-1} \to[...]" class="tex" src="Inclusion%20Exclusion_files/99ffbf625dd996a83712de29a8cc5cd9.png"></p><p>Easiest way to calculate this amount by comparing it to the decomposition of the Newton binomial expression <img alt="(1-x)^k" class="tex" src="Inclusion%20Exclusion_files/99cb5d15a9ce0ac6f0c7d35565e2dbc0.png">:</p><p></p><p class="formula"><img alt=" (1-x)^k = C_k^0 - C_k^1 \cdot x + C_k^2 \cdot x^2[...]" class="tex" src="Inclusion%20Exclusion_files/d7f2cd59a92544f845e30b21cd464d88.png"></p><p>It can be seen that <img alt="x=1" class="tex" src="Inclusion%20Exclusion_files/b137898897330f37670f24e31e9340dd.png"> the expression <img alt="(1-x)^k" class="tex" src="Inclusion%20Exclusion_files/99cb5d15a9ce0ac6f0c7d35565e2dbc0.png"> is not that other, as <img alt="1 - T" class="tex" src="Inclusion%20Exclusion_files/0701550acc48a66816be7c3bbe9aa2a9.png">. Therefore <img alt="T = 1 - (1-1)^k = 1" class="tex" src="Inclusion%20Exclusion_files/85da0e3bd30b1dffb1f8eb2746f41fbf.png">, what we wanted to prove.</p><p></p><p></p><h2 style="padding-top:40px;"> Use when solving problems </h2><p>The principle of inclusions-exclusions are difficult to understand without studying the examples of its applications.</p><p>We
 rst consider three simple tasks on paper, illustrating the application 
of the principle, then consider the more practical problems which are 
difficult to solve without using the principle of inclusions-exceptions.</p><p>Of
 particular note the task "finding the number of ways" because it 
demonstrates that the principle of inclusions-exceptions can sometimes 
lead to polynomial solutions, but not necessarily exponential.</p><p></p><p></p><h3 style="padding-top:15px;"> A simple problem about permutations </h3><p>How many have permutations of the integers from <img alt="0" class="tex" src="Inclusion%20Exclusion_files/d796aaaffd5bff4144c8ac3509c1d33d.png"> to <img alt="9" class="tex" src="Inclusion%20Exclusion_files/141aa12977eb90edab9130cae519bccf.png"> such that the first element is more <img alt="1" class="tex" src="Inclusion%20Exclusion_files/1737ac55fdbc871d8c7d14245b749ccd.png">and the latter less <img alt="8" class="tex" src="Inclusion%20Exclusion_files/fa6a7da1482cae770cdfc2108255c1b8.png">?</p><p>Let's count the number of "bad" permutations, i.e., in which the first element <img alt="\le 1" class="tex" src="Inclusion%20Exclusion_files/b377390b983b51536621158e6cf14ba2.png"> and/or the last <img alt="\ge 8" class="tex" src="Inclusion%20Exclusion_files/47f15f62613b7020e6ee8b8d0bfc28d3.png">.</p><p>We denote <img alt="X" class="tex" src="Inclusion%20Exclusion_files/6c40947c41a939b41e0cfe6506c9e3c8.png"> the set of permutations, in which the first element <img alt="\le 1" class="tex" src="Inclusion%20Exclusion_files/b377390b983b51536621158e6cf14ba2.png">, and through <img alt="Y" class="tex" src="Inclusion%20Exclusion_files/2f103fbb20004cd7122d15d73c2acaf0.png"> — which the last element <img alt="\ge 8" class="tex" src="Inclusion%20Exclusion_files/47f15f62613b7020e6ee8b8d0bfc28d3.png">. Then the number of "bad" permutations on the formula of inclusions-exceptions is:</p><p></p><p class="formula"><img alt=" |X| + |Y| - |X \cap Y|. " class="tex" src="Inclusion%20Exclusion_files/222afae8dbc4c26218bba4d60616c975.png"></p><p>After a simple combinatorial calculation, we obtain that it is equal to:</p><p></p><p class="formula"><img alt=" 2 \cdot 9! + 2 \cdot 9! - 2 \cdot 2 \cdot 8! " class="tex" src="Inclusion%20Exclusion_files/da8b10994848bf3744f83f691f3cf9fa.png"></p><p>Subtracting this number from the total number of permutations <img alt="10!" class="tex" src="Inclusion%20Exclusion_files/24709b1f0ade7d1324c60bbe907497af.png">, we get a response.</p><p></p><p></p><h3 style="padding-top:15px;"> A simple puzzle about the (0,1,2) sequences </h3><p>How many sequences of length n <img alt="n" class="tex" src="Inclusion%20Exclusion_files/8bc19c5640342f9c5ad0ba16baf59981.png">consisting only of numbers <img alt="0,1,2" class="tex" src="Inclusion%20Exclusion_files/3dd6758a1a3045d8455c95b3ba701946.png">, and each number occurs at least once?</p><p>Again turn to the inverse problem, i.e. we will count the number of sequences in which there is at least one of the numbers.</p><p>Denote by <img alt="A_i" class="tex" src="Inclusion%20Exclusion_files/ecd1f057d6ceb5ed438e560f05b03792.png"> (<img alt="i = 0 \ldots 2" class="tex" src="Inclusion%20Exclusion_files/a5d79ddb1078644ca8c7c131d5dc8f63.png">) the set of sequences in which the number is not found <img alt="i" class="tex" src="Inclusion%20Exclusion_files/2d9d1096e116db33bc39a0accf4e9ef7.png">. Then by the formula of inclusions-exceptions the number of "bad" sequences is equal to:</p><p></p><p class="formula"><img alt=" |A_0| + |A_1| + |A_2| - |A_0 \cap A_1| - |A_0 \ca[...]" class="tex" src="Inclusion%20Exclusion_files/cf9302ef0ae566f3e29db122f2b922f1.png"></p><p>The size of each of <img alt="A_i" class="tex" src="Inclusion%20Exclusion_files/ecd1f057d6ceb5ed438e560f05b03792.png"> equal, obviously, <img alt="2^n" class="tex" src="Inclusion%20Exclusion_files/f26be6eff0bc0813c49c4125743c6e55.png"> (because such sequences can occur only two digits). The power of each pairwise intersection <img alt="A_i \cap A_j" class="tex" src="Inclusion%20Exclusion_files/663d0fa1eca6824569ff225acdaf13ab.png"> is $ <img alt="1" class="tex" src="Inclusion%20Exclusion_files/1737ac55fdbc871d8c7d14245b749ccd.png"> (because there is only one digit). Finally, power, the intersection of all three sets are equal <img alt="0" class="tex" src="Inclusion%20Exclusion_files/d796aaaffd5bff4144c8ac3509c1d33d.png"> (since the available figures do not remain).</p><p>Remembering how we solved the inverse problem, we obtain the final <b>answer</b>:</p><p></p><p class="formula"><img alt=" 3^n - 3 \cdot 2^n + 3 \cdot 1 - 0. " class="tex" src="Inclusion%20Exclusion_files/99c0fe5e12daa0e3320b9181b7c864a8.png"></p><p></p><p></p><h3 style="padding-top:15px;"> The number of integer solutions of the equation </h3><p>Given the equation:</p><p></p><p class="formula"><img alt=" x_1 + x_2 + x_3 + x_4 + x_5 + x_6 = 20, " class="tex" src="Inclusion%20Exclusion_files/757b3e13097b1fccea9e5fc8b042983c.png"></p><p>where all <img alt="0 \le x_i \le 8" class="tex" src="Inclusion%20Exclusion_files/fda296868c223899d783d1fc6b9318d8.png"> (where <img alt="i = 1 \ldots 6" class="tex" src="Inclusion%20Exclusion_files/ccfa01d64af7888b193ecb015163ca0d.png">).</p><p>You want to count the number of solutions of this equation.</p><p>Forget first about the restriction <img alt="x_i \le 8" class="tex" src="Inclusion%20Exclusion_files/49b55efc1f7c102d996c2566c0d819c1.png">, and just count the number of nonnegative solutions of this equation. This is easily done using <a href="https://z5h64q92x9.net/proxy_u/ru-en.en/e-maxx.ru/algo/binomial_coeff">the binomial coefficients</a> we want to break <img alt="20" class="tex" src="Inclusion%20Exclusion_files/5e7759304ea771e5b17cc15648bdae1f.png"> elements in <img alt="6" class="tex" src="Inclusion%20Exclusion_files/4865d5147ae3eb875ffc560f11594965.png"> groups, i.e. to distribute the <img alt="5" class="tex" src="Inclusion%20Exclusion_files/ffd5c7a480888cf433d3b57d36bd7c52.png"> "walls" separating groups of <img alt="25" class="tex" src="Inclusion%20Exclusion_files/714792ad1bd0a7e1c581c9274327dcc3.png"> sites:</p><p></p><p class="formula"><img alt=" N_0 = C_{25}^5 " class="tex" src="Inclusion%20Exclusion_files/847e01e12ae34c0ed82fca22a977b885.png"></p><p>Now
 calculate by the formula of inclusions-exceptions the number of "bad" 
solutions, i.e. solutions of the equation in which one or more <img alt="x_i" class="tex" src="Inclusion%20Exclusion_files/bdf4742dd10f0eb4f2b7801e40b0e129.png"> more <img alt="9" class="tex" src="Inclusion%20Exclusion_files/141aa12977eb90edab9130cae519bccf.png">.</p><p>Denote by <img alt="A_k" class="tex" src="Inclusion%20Exclusion_files/52475edaf8bceaddcd5bcedf63f73e80.png"> (where <img alt="k = 1 \ldots 6" class="tex" src="Inclusion%20Exclusion_files/b853681ed2f344e902da712a25cd800b.png">) the set of such solutions of the equation where <img alt="x_k \ge 9" class="tex" src="Inclusion%20Exclusion_files/eb3f76d7002b4f23f0b402300209ac46.png">, and all the others <img alt="x_i \ge 0" class="tex" src="Inclusion%20Exclusion_files/a8f947bdba13d365354eb59a1580d684.png"> (for all <img alt="i \ne k" class="tex" src="Inclusion%20Exclusion_files/e0982d94448fe632b16dc38a86b9ec22.png">). To calculate the size of the array <img alt="A_k" class="tex" src="Inclusion%20Exclusion_files/52475edaf8bceaddcd5bcedf63f73e80.png">, note that we have essentially the same combinatorial problem that was solved two paragraphs above, only now <img alt="9" class="tex" src="Inclusion%20Exclusion_files/141aa12977eb90edab9130cae519bccf.png"> the elements are excluded from consideration and belong to the first group. Thus:</p><p></p><p class="formula"><img alt=" | A_k | = C_{16}^5 " class="tex" src="Inclusion%20Exclusion_files/cdb38f4362f71a5e5813486b719f0c59.png"></p><p>Similarly, the capacity of the intersection of two sets <img alt="A_k" class="tex" src="Inclusion%20Exclusion_files/52475edaf8bceaddcd5bcedf63f73e80.png"> and <img alt="A_p" class="tex" src="Inclusion%20Exclusion_files/015e5e292a6d566add693c33eb6cb3d7.png"> is equal to the number:</p><p></p><p class="formula"><img alt=" \left| A_k \cap A_p \right| = C_7^5 " class="tex" src="Inclusion%20Exclusion_files/a3e31cbc667c6ffb5239d579feff6f68.png"></p><p>The capacity of each intersection of three or more sets is zero, since <img alt="20" class="tex" src="Inclusion%20Exclusion_files/5e7759304ea771e5b17cc15648bdae1f.png"> the elements will not be enough for three or more variables, greater than or equal to <img alt="9" class="tex" src="Inclusion%20Exclusion_files/141aa12977eb90edab9130cae519bccf.png">.</p><p>Combining all this into the formula of inclusions-exceptions and given that we solved the inverse problem, finally, we obtain <b>the answer</b>:</p><p></p><p class="formula"><img alt=" C_{25}^5 - C_6^1 \cdot C_{16}^5 + C_6^2 \cdot C_7[...]" class="tex" src="Inclusion%20Exclusion_files/b9dd59d35e0ffb3d87655a205ef1efd6.png"></p><p></p><p></p><h3 style="padding-top:15px;"> The number of relatively Prime numbers in the given range </h3><p>Let the given numbers <img alt="n" class="tex" src="Inclusion%20Exclusion_files/8bc19c5640342f9c5ad0ba16baf59981.png"> and <img alt="r" class="tex" src="Inclusion%20Exclusion_files/d51b82f01bc38fe0d2e4a69ebec7c641.png">. You want to count the number of numbers in the interval <img alt="[1; r]" class="tex" src="Inclusion%20Exclusion_files/cbbe446745deee8da70e67040c523d61.png">that are relatively Prime with <img alt="n" class="tex" src="Inclusion%20Exclusion_files/8bc19c5640342f9c5ad0ba16baf59981.png">.</p><p>Go straight to the inverse problem — calculate the number of non mutually Prime numbers.</p><p>Consider all the Prime factors of a number <img alt="n" class="tex" src="Inclusion%20Exclusion_files/8bc19c5640342f9c5ad0ba16baf59981.png">; let us denote them using <img alt="p_i" class="tex" src="Inclusion%20Exclusion_files/b98bee3099688d9f0572adb2ffa3ff68.png"> (<img alt="i = 1 \ldots k" class="tex" src="Inclusion%20Exclusion_files/ce45baeaf3e1c4732cc9524411d4cac8.png">).</p><p>How many numbers are in the interval <img alt="[1;r]" class="tex" src="Inclusion%20Exclusion_files/e4a06f9ab811b62765e6bc1cb768d161.png">divisible by <img alt="p_i" class="tex" src="Inclusion%20Exclusion_files/b98bee3099688d9f0572adb2ffa3ff68.png">? Their number is:</p><p></p><p class="formula"><img alt=" \left\lfloor \frac{ r }{ p_i } \right\rfloor " class="tex" src="Inclusion%20Exclusion_files/f80ff8ea9069fd3b81b7629e5bf8074e.png"></p><p>However,
 if we simply sum these numbers, we get the wrong answer — some numbers 
will be totaled several times (those that share multiple <img alt="p_i" class="tex" src="Inclusion%20Exclusion_files/b98bee3099688d9f0572adb2ffa3ff68.png">). Therefore it is necessary to use the formula of inclusions-exceptions.</p><p>For example, <img alt="2^k" class="tex" src="Inclusion%20Exclusion_files/a631b6ee74bdfc6711813da7ca95a648.png"> to iterate over a subset of the set of all <img alt="p_i" class="tex" src="Inclusion%20Exclusion_files/b98bee3099688d9f0572adb2ffa3ff68.png">'s, calculate their product and add or subtract in the formula of inclusions-exceptions next term.</p><p>The final <b>implementation is</b> to count the number of relatively Prime numbers:</p><p></p><pre class="notranslate cpp"><span class="kw4">int</span> solve <span class="br0">(</span><span class="kw4">int</span> n, <span class="kw4">int</span> r<span class="br0">)</span> <span class="br0">{</span>
 vector<span class="sy1">&lt;</span><span class="kw4">int</span><span class="sy1">&gt;</span> p<span class="sy4">;</span>
	<span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> i<span class="sy1">=</span><span class="nu0">2</span><span class="sy4">;</span> i<span class="sy2">*</span>i<span class="sy1">&lt;=</span>n<span class="sy4">;</span> <span class="sy2">++</span>i<span class="br0">)</span>
		<span class="kw1">if</span> <span class="br0">(</span>n <span class="sy2">%</span> i <span class="sy1">==</span> <span class="nu0">0</span><span class="br0">)</span> <span class="br0">{</span>
 p.<span class="me1">push_back</span> <span class="br0">(</span>i<span class="br0">)</span><span class="sy4">;</span>
			<span class="kw1">while</span> <span class="br0">(</span>n <span class="sy2">%</span> i <span class="sy1">==</span> <span class="nu0">0</span><span class="br0">)</span>
 n <span class="sy2">/</span><span class="sy1">=</span> i<span class="sy4">;</span>
		<span class="br0">}</span>
	<span class="kw1">if</span> <span class="br0">(</span>n <span class="sy1">&gt;</span> <span class="nu0">1</span><span class="br0">)</span>
 p.<span class="me1">push_back</span> <span class="br0">(</span>n<span class="br0">)</span><span class="sy4">;</span>
&nbsp;
	<span class="kw4">int</span> sum <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span>
	<span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> msk<span class="sy1">=</span><span class="nu0">1</span><span class="sy4">;</span> msk<span class="sy1">&lt;</span><span class="br0">(</span><span class="nu0">1</span><span class="sy1">&lt;&lt;</span>p.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy4">;</span> <span class="sy2">++</span>msk<span class="br0">)</span> <span class="br0">{</span>
		<span class="kw4">int</span> mult <span class="sy1">=</span> <span class="nu0">1</span>,
 bits <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span>
		<span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> i<span class="sy1">=</span><span class="nu0">0</span><span class="sy4">;</span> i<span class="sy1">&lt;</span><span class="br0">(</span><span class="kw4">int</span><span class="br0">)</span>p.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span> <span class="sy2">++</span>i<span class="br0">)</span>
			<span class="kw1">if</span> <span class="br0">(</span>msk <span class="sy3">&amp;</span> <span class="br0">(</span><span class="nu0">1</span><span class="sy1">&lt;&lt;</span>i<span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
				<span class="sy2">++</span>bits<span class="sy4">;</span>
 mult <span class="sy2">*</span><span class="sy1">=</span> p<span class="br0">[</span>i<span class="br0">]</span><span class="sy4">;</span>
			<span class="br0">}</span>
&nbsp;
		<span class="kw4">int</span> cur <span class="sy1">=</span> r <span class="sy2">/</span> mult<span class="sy4">;</span>
		<span class="kw1">if</span> <span class="br0">(</span>bits <span class="sy2">%</span> <span class="nu0">2</span> <span class="sy1">==</span> <span class="nu0">1</span><span class="br0">)</span>
 sum <span class="sy2">+</span><span class="sy1">=</span> cur<span class="sy4">;</span>
		<span class="kw1">else</span>
 sum <span class="sy2">-</span><span class="sy1">=</span> cur<span class="sy4">;</span>
	<span class="br0">}</span>
&nbsp;
	<span class="kw1">return</span> r <span class="sy2">-</span> sum<span class="sy4">;</span>
<span class="br0">}</span></pre><p>Asymptotics of the solution is <img alt="O (\sqrt{n})" class="tex" src="Inclusion%20Exclusion_files/60208aa299c4789f19cb5dcf9463ba9a.png">.</p><p></p><p></p><h3 style="padding-top:15px;"> The number of numbers in the given range divisible by at least one of the given numbers </h3><p>Given <img alt="n" class="tex" src="Inclusion%20Exclusion_files/8bc19c5640342f9c5ad0ba16baf59981.png"> numbers <img alt="a_i" class="tex" src="Inclusion%20Exclusion_files/ef875bf5bad8370d4f3bbe3c740d3dd3.png"> and a number <img alt="r" class="tex" src="Inclusion%20Exclusion_files/d51b82f01bc38fe0d2e4a69ebec7c641.png">. You want to count the number of numbers in the interval <img alt="[1; r]" class="tex" src="Inclusion%20Exclusion_files/cbbe446745deee8da70e67040c523d61.png">that is a multiple of at least one of <img alt="a_i" class="tex" src="Inclusion%20Exclusion_files/ef875bf5bad8370d4f3bbe3c740d3dd3.png">.</p><p>The solution algorithm is almost identical to the previous task — do the formula of inclusions-exceptions on numbers <img alt="a_i" class="tex" src="Inclusion%20Exclusion_files/ef875bf5bad8370d4f3bbe3c740d3dd3.png">, i.e. each term in this formula is the number of numbers divisible by a given subset of numbers <img alt="a_i" class="tex" src="Inclusion%20Exclusion_files/ef875bf5bad8370d4f3bbe3c740d3dd3.png"> (in other words, divisible by their <a href="https://z5h64q92x9.net/proxy_u/ru-en.en/e-maxx.ru/algo/euclid_algorithm">least common multiple</a>).</p><p>Thus, the solution is to for <img alt="2^n" class="tex" src="Inclusion%20Exclusion_files/f26be6eff0bc0813c49c4125743c6e55.png"> to iterate over a subset of numbers, <img alt="O(n \log r)" class="tex" src="Inclusion%20Exclusion_files/a156bb24e0dde4e6132938205f7fd6c6.png"> operations, to find their least common multiple, and add or subtract from the response another value.</p><p></p><p></p><h3 style="padding-top:15px;"> The number of rows that satisfy a given number pattern </h3><p>Given <img alt="n" class="tex" src="Inclusion%20Exclusion_files/8bc19c5640342f9c5ad0ba16baf59981.png"> patterns — strings of the same length, consisting only of letters and question marks. Also given the number <img alt="k" class="tex" src="Inclusion%20Exclusion_files/252410059470b019db6fd4c3b844a348.png">. You want to count the number of rows that match exactly <img alt="k" class="tex" src="Inclusion%20Exclusion_files/252410059470b019db6fd4c3b844a348.png"> the pattern or, in another formulation, at least <img alt="k" class="tex" src="Inclusion%20Exclusion_files/252410059470b019db6fd4c3b844a348.png"> the patterns.</p><p>Note rst that we can <b>easily count the number of rows</b>that
 satisfy all the specified patterns. To do this, just "cross" these 
patterns: look at the first character (whether in all patterns at the 
first position is the question, or not all — then the first character is
 unambiguous), the second character, etc.</p><p>Learn now to solve <b>the first version of the problem</b>: when the search strings must satisfy exactly one <img alt="k" class="tex" src="Inclusion%20Exclusion_files/252410059470b019db6fd4c3b844a348.png"> of the patterns.</p><p>To do this, iterate and sapxaswul a specific subset <img alt="X" class="tex" src="Inclusion%20Exclusion_files/6c40947c41a939b41e0cfe6506c9e3c8.png"> of patterns of size <img alt="k" class="tex" src="Inclusion%20Exclusion_files/252410059470b019db6fd4c3b844a348.png">
 — now we have to count the number of rows that satisfy this set of 
patterns only. For this we use the formula of inclusions-exceptions: we 
sum over all supersets of sets <img alt="X" class="tex" src="Inclusion%20Exclusion_files/6c40947c41a939b41e0cfe6506c9e3c8.png">, and either add to the current answer, or subtracted from it the number of rows that matched the current set:</p><p></p><p class="formula"><img alt=" ans(X) = \sum_{Y \supseteq X} (-1)^{|Y|-k} \cdot [...]" class="tex" src="Inclusion%20Exclusion_files/a75610f3aa3ea4f6c5a2076cdb953b31.png"></p><p>where <img alt="f(Y)" class="tex" src="Inclusion%20Exclusion_files/8af77b51e31c01f292544087fd9d758e.png"> denotes the number of rows matching a set of patterns <img alt="Y" class="tex" src="Inclusion%20Exclusion_files/2f103fbb20004cd7122d15d73c2acaf0.png">.</p><p>If we sum up <img alt="ans(X)" class="tex" src="Inclusion%20Exclusion_files/b842c4ce57f80051c6637e7adfb7f992.png"> all <img alt="X" class="tex" src="Inclusion%20Exclusion_files/6c40947c41a939b41e0cfe6506c9e3c8.png">, we get the answer:</p><p></p><p class="formula"><img alt=" ans = \sum_{X ~ : ~ |X| = k} ans(X). " class="tex" src="Inclusion%20Exclusion_files/32da461f2e7193c688ef7942a7fab0a9.png"></p><p>However, in doing so, we received a decision during the procedure <img alt="O(3^k \cdot k)" class="tex" src="Inclusion%20Exclusion_files/7fb0c4005771e5d7e590a70c309d0b3d.png">.</p><p>The solution can be accelerated by observing that in different <img alt="ans(X)" class="tex" src="Inclusion%20Exclusion_files/b842c4ce57f80051c6637e7adfb7f992.png"> summation often is conducted on the same sets <img alt="Y" class="tex" src="Inclusion%20Exclusion_files/2f103fbb20004cd7122d15d73c2acaf0.png">.</p><p>Turn over the formula of inclusions-exceptions will be conducting the summation <img alt="Y" class="tex" src="Inclusion%20Exclusion_files/2f103fbb20004cd7122d15d73c2acaf0.png">. Then it is easy to understand that many <img alt="Y" class="tex" src="Inclusion%20Exclusion_files/2f103fbb20004cd7122d15d73c2acaf0.png"> will be taken into account in <img alt="C_{|Y|}^k" class="tex" src="Inclusion%20Exclusion_files/692a04895a43b36360bda1242b9aef25.png"> the formula of inclusions-exceptions, everywhere with the same sign <img alt="(-1)^{|Y|-k}" class="tex" src="Inclusion%20Exclusion_files/287a265f55d4088fe6c2d5fa5e51238d.png">:</p><p></p><p class="formula"><img alt=" ans = \sum_{Y ~ : ~ |Y| \ge k} (-1)^{|Y|-k} \cdot[...]" class="tex" src="Inclusion%20Exclusion_files/c7fdf3993a8d3a8448492b50ab400ee8.png"></p><p>The decision turned out to the asymptotics <img alt="O(2^k \cdot k)" class="tex" src="Inclusion%20Exclusion_files/335e2d51d76d202b9e4ecbfc48848860.png">.</p><p>We turn now to <b>the second embodiment of the task</b>: when the desired row must meet at least <img alt="k" class="tex" src="Inclusion%20Exclusion_files/252410059470b019db6fd4c3b844a348.png"> the patterns.</p><p>Okay, we can just use the first variant of the exercise and summarize the answers from <img alt="k" class="tex" src="Inclusion%20Exclusion_files/252410059470b019db6fd4c3b844a348.png"> before <img alt="n" class="tex" src="Inclusion%20Exclusion_files/8bc19c5640342f9c5ad0ba16baf59981.png">. However, you notice that all the arguments will still be correct, only in this version of the task, the amount <img alt="X" class="tex" src="Inclusion%20Exclusion_files/6c40947c41a939b41e0cfe6506c9e3c8.png"> is not only for those sets whose size is equal to <img alt="k" class="tex" src="Inclusion%20Exclusion_files/252410059470b019db6fd4c3b844a348.png">and for all sets with size <img alt="\ge k" class="tex" src="Inclusion%20Exclusion_files/9d2dac01a5ebeff005f7464d36969397.png">.</p><p>Thus, in the final formula before you <img alt="f(Y)" class="tex" src="Inclusion%20Exclusion_files/8af77b51e31c01f292544087fd9d758e.png"> will stand another ratio: not the only one binomial coefficient with a sign, and their sum:</p><p></p><p class="formula"><img alt=" (-1)^{|Y|-k} \cdot C_{|Y|}^k ~~ + ~~ (-1)^{|Y|-k-[...]" class="tex" src="Inclusion%20Exclusion_files/9164cb87882544d9276d05be38ef3e68.png"></p><p>Looking at Graham (<a href="http://e-maxx.ru/bookz/files/graham.djvu">Graham, Knuth, Patashnik. <b>"Concrete mathematics"</b> [1998]</a> ), we see a well-known formula for <a href="https://z5h64q92x9.net/proxy_u/ru-en.en/e-maxx.ru/algo/binomial_coeff">binomial coefficients</a>:</p><p></p><p class="formula"><img alt=" \sum_{k=0}^m (-1)^k \cdot C_n^k = (-1)^m \cdot C_[...]" class="tex" src="Inclusion%20Exclusion_files/002e825cb580b5afed1ce62deeefd3af.png"></p><p>Applying it here, we obtain that the entire sum of binomial coefficients is minimized to:</p><p></p><p class="formula"><img alt=" (-1)^{|Y|-k} \cdot C_{|Y|-1}^{|Y|-k}. " class="tex" src="Inclusion%20Exclusion_files/f0e536b9d9d8c07e086ae864dff98fe5.png"></p><p>Thus, for this option we would have got the solution with the asymptotics <img alt="O(2^k \cdot k)" class="tex" src="Inclusion%20Exclusion_files/335e2d51d76d202b9e4ecbfc48848860.png">:</p><p></p><p class="formula"><img alt=" ans = \sum_{Y ~ : ~ |Y| \ge k} (-1)^{|Y|-k} \cdot[...]" class="tex" src="Inclusion%20Exclusion_files/bdcaf0fc8679ec8f90b00393def2f67f.png"></p><p></p><p></p><h3 style="padding-top:15px;"> The number of paths </h3><p>There is a field <img alt="n \times m" class="tex" src="Inclusion%20Exclusion_files/ed0e13f7024ff254a4fccd689fe21ad3.png">, some <img alt="k" class="tex" src="Inclusion%20Exclusion_files/252410059470b019db6fd4c3b844a348.png"> cells of which is an impassable wall. On the field in the cell <img alt="(1,1)" class="tex" src="Inclusion%20Exclusion_files/9ad54f612d8142111f513e21ae0a2830.png"> (bottom left cell) is initially the robot. The robot can only move right or up, and eventually it needs to get into the cage <img alt="(n,m)" class="tex" src="Inclusion%20Exclusion_files/00ee56d26fde8408a67d3be82336f527.png">, avoiding all obstacles. You want to count the number of ways he can do it.</p><p>Assume that the sizes <img alt="n" class="tex" src="Inclusion%20Exclusion_files/8bc19c5640342f9c5ad0ba16baf59981.png"> and <img alt="m" class="tex" src="Inclusion%20Exclusion_files/4f70748eaed5e0c2c70d7e899166ee1d.png"> very large (say, <img alt="10^9" class="tex" src="Inclusion%20Exclusion_files/444ed8a79d12976910378f0f39064696.png">), and the number <img alt="k" class="tex" src="Inclusion%20Exclusion_files/252410059470b019db6fd4c3b844a348.png"> is small (of the order <img alt="100" class="tex" src="Inclusion%20Exclusion_files/42eebf03554591becb9bdde682ba1fbf.png">).</p><p>To solve for the sake of convenience <b>let's sort</b> the obstacles in the order in which we can get around them: i.e., for example, in the coordinate <img alt="x" class="tex" src="Inclusion%20Exclusion_files/4a9252cee23f1a80a4e03256ef62d733.png">, and in case of equality — coordinate <img alt="y" class="tex" src="Inclusion%20Exclusion_files/e1fbf2db960f0155bd590871a486e78c.png">.</p><p>Also
 just learn how to solve a problem without obstacles: i.e. to compute 
the number of ways to walk from one cell to another. If in one 
coordinate we need to go through <img alt="x" class="tex" src="Inclusion%20Exclusion_files/4a9252cee23f1a80a4e03256ef62d733.png"> cells, and other <img alt="y" class="tex" src="Inclusion%20Exclusion_files/e1fbf2db960f0155bd590871a486e78c.png"> cells, from simple combinatorics we get such a formula using <a href="https://z5h64q92x9.net/proxy_u/ru-en.en/e-maxx.ru/algo/binomial_coeff">the binomial coefficients</a>:</p><p></p><p class="formula"><img alt=" C_{x+y}^{x} " class="tex" src="Inclusion%20Exclusion_files/94e4cb58a5728113c1a06b1631ba7b96.png"></p><p>Now to count the number of ways to walk from one cell to another, avoiding all obstacles, you can use <b>the formula of inclusions-exceptions</b>: count the number of ways to walk, stepping on at least one obstacle.</p><p>For
 example, to iterate over a subset of those obstacles that we'll step, 
to count the number of ways to do this (simply multiplying the number of
 ways to walk from a starting cell until the first of the selected 
obstacles, the first obstacle to the second, and so on), and then add or
 subtract this number from the answer, in accordance with the standard 
formula of inclusions-exceptions.</p><p>However, it will again be non-polynomial solution for the asymptotic behavior <img alt="O (2^k k)" class="tex" src="Inclusion%20Exclusion_files/e936a40958e43323a2fc4e6485cbe164.png">. We show how to obtain <b>polynomial solution</b>.</p><p>To deal with will <b>dynamic programming</b>: learn how to calculate the numbers <img alt="d[i][j]" class="tex" src="Inclusion%20Exclusion_files/a18f11689b09b23faa10c78d6b244cf8.png"> — the number of ways to walk from the <img alt="i" class="tex" src="Inclusion%20Exclusion_files/2d9d1096e116db33bc39a0accf4e9ef7.png">second point to <img alt="j" class="tex" src="Inclusion%20Exclusion_files/f2761432c5377ee4ded848884be6d407.png">-Oh, without stepping on any one obstacle (besides themselves <img alt="i" class="tex" src="Inclusion%20Exclusion_files/2d9d1096e116db33bc39a0accf4e9ef7.png"> and <img alt="j" class="tex" src="Inclusion%20Exclusion_files/f2761432c5377ee4ded848884be6d407.png">, of course). We will have <img alt="k+2" class="tex" src="Inclusion%20Exclusion_files/fc0ba147e6448702aec70ee6ec529a6f.png"> the points as obstacles are added the start and end cells.</p><p>If we for a moment forget about all the obstacles and just count the number of paths from cell <img alt="i" class="tex" src="Inclusion%20Exclusion_files/2d9d1096e116db33bc39a0accf4e9ef7.png"> to cell <img alt="j" class="tex" src="Inclusion%20Exclusion_files/f2761432c5377ee4ded848884be6d407.png">,
 we will consider some of the "bad" path, passing through obstacles. 
Learn how to count the number of these "bad" ways. Let's consider the 
first of the obstacles <img alt="i &lt; t &lt; j" class="tex" src="Inclusion%20Exclusion_files/feea1196596436ba1623a15c43ce0674.png">, on which we step, then the number of paths will be equal to <img alt="d[i][t]" class="tex" src="Inclusion%20Exclusion_files/00fc1505d13050d06855542ec55e219d.png">multiplied by the number of arbitrary paths from <img alt="t" class="tex" src="Inclusion%20Exclusion_files/668c0ed766381807a81b9a534a4a70ce.png"> to <img alt="j" class="tex" src="Inclusion%20Exclusion_files/f2761432c5377ee4ded848884be6d407.png">. Summing it all <img alt="t" class="tex" src="Inclusion%20Exclusion_files/668c0ed766381807a81b9a534a4a70ce.png">, we count the number of "bad" ways.</p><p>Thus, the value <img alt="d[i][j]" class="tex" src="Inclusion%20Exclusion_files/a18f11689b09b23faa10c78d6b244cf8.png"> we learned to count for the time <img alt="O(k)" class="tex" src="Inclusion%20Exclusion_files/ac686865eeed9866e9f70fcbc1e9b6e5.png">. Therefore, the solution to the problem has complexity <img alt="O(k^3)" class="tex" src="Inclusion%20Exclusion_files/c89122c987e30c62ea95ad2c3af1d6f3.png">.</p><p></p><p></p><h3 style="padding-top:15px;"> The number of coprime quadruples </h3><p>Given <img alt="n" class="tex" src="Inclusion%20Exclusion_files/8bc19c5640342f9c5ad0ba16baf59981.png"> numbers: <img alt="a_1, a_2, \ldots, a_n" class="tex" src="Inclusion%20Exclusion_files/6746a24b8742fb7b6e4b25bf190cdea4.png">. You want to count the number of ways to choose four numbers so that their combined greatest common divisor equal to one.</p><p>We
 will solve the inverse problem — calculate the number of "bad" 
quadruples, i.e. quadruples for which all numbers can be divided by the 
number <img alt="d &gt; 1" class="tex" src="Inclusion%20Exclusion_files/37a977017f6b5af9957bf42d1423a502.png">.</p><p>We use the formula of inclusions-exceptions by summing the number of groups of four, divisible by the divisor <img alt="d" class="tex" src="Inclusion%20Exclusion_files/30956e25578e9cb8f03bd9d36433020c.png"> (but perhaps divisible and the greater the divisor):</p><p></p><p class="formula"><img alt=" ans = \sum_{d \ge 2} (-1)^{deg(d)-1} \cdot f(d), " class="tex" src="Inclusion%20Exclusion_files/8a321b2b3e2559c7431783b1a6a198b6.png"></p><p>where <img alt="deg(d)" class="tex" src="Inclusion%20Exclusion_files/0e38081833e1b3a5f0a658559c5d3a1a.png"> is the number of Prime factorization in number <img alt="d" class="tex" src="Inclusion%20Exclusion_files/30956e25578e9cb8f03bd9d36433020c.png">, <img alt="f(d)" class="tex" src="Inclusion%20Exclusion_files/73e725a0475e487bba893e78885a8886.png"> — the number four is divisible by <img alt="d" class="tex" src="Inclusion%20Exclusion_files/30956e25578e9cb8f03bd9d36433020c.png">.</p><p>To calculate the function <img alt="f(d)" class="tex" src="Inclusion%20Exclusion_files/73e725a0475e487bba893e78885a8886.png">, you just have to count the number of numbers that are multiples of <img alt="d" class="tex" src="Inclusion%20Exclusion_files/30956e25578e9cb8f03bd9d36433020c.png">, and <a href="https://z5h64q92x9.net/proxy_u/ru-en.en/e-maxx.ru/algo/binomial_coeff">the binomial coefficient</a> to count the number of ways to choose four of them.</p><p>Thus,
 using the formula of inclusions-exceptions we sum the number of groups 
of four, divisible by a Prime number, then subtract the number four is 
divisible by the product of two primes, add four, divisible by three 
simple, etc.</p><p></p><p></p><h3 style="padding-top:15px;"> The number of harmonic triplets </h3><p>Given the number of <img alt="n \le 10^6" class="tex" src="Inclusion%20Exclusion_files/74e6878028e83a0aedbdf342a8100445.png">. Your task is to count the number of such triples of numbers <img alt="2 \le a &lt; b &lt; c \le n" class="tex" src="Inclusion%20Exclusion_files/309d78d0e6b6c77bc5e39891c95b3aae.png">that they are harmonic triads, namely:</p><p></p><ul><p></p><li>or <img alt="{\rm gcd}(a,b) = {\rm gcd}(a,c) = {\rm gcd}(b,c) = 1" class="tex" src="Inclusion%20Exclusion_files/89d21dacb8b79f22b0fbce3d3395d3d9.png">,</li><li>or <img alt="{\rm gcd}(a,b) &gt; 1" class="tex" src="Inclusion%20Exclusion_files/4892fef848fec836d43d30c313890b50.png">, <img alt="{\rm gcd}(a,c) &gt; 1" class="tex" src="Inclusion%20Exclusion_files/c2be125ab8ff9416d384af834ac4d608.png">, <img alt="{\rm gcd}(b,c) &gt; 1" class="tex" src="Inclusion%20Exclusion_files/2f4d9f2defeec96196ff625ace08d551.png">.<p></p></li></ul><p>First, go straight to the inverse problem — i.e. count the number of non-harmonic triples.</p><p>Secondly,
 note that in any non-harmonic three exactly two of its numbers are in 
such a situation, what is the number of mutually simple with one number 
three, and not one just with a different number of triples.</p><p>Thus, the number of non-harmonic triples is the sum of all numbers from <img alt="2" class="tex" src="Inclusion%20Exclusion_files/1f68ec6d6ed94148fc6fb5efafc8a688.png"> to <img alt="n" class="tex" src="Inclusion%20Exclusion_files/8bc19c5640342f9c5ad0ba16baf59981.png"> the number coprime with the current number of integers in a number not coprime numbers.</p><p>Now all that is left for us to solve the problem is to learn how to count for each number in the interval <img alt="[2;n]" class="tex" src="Inclusion%20Exclusion_files/844775997e9571036d4f38fb520ee6e8.png">
 the number of numbers relatively Prime (or coprime) with him. Although 
this task has already been highlighted, this solution is not appropriate
 here — it would require the factorization of the integers from <img alt="2" class="tex" src="Inclusion%20Exclusion_files/1f68ec6d6ed94148fc6fb5efafc8a688.png"> to <img alt="n" class="tex" src="Inclusion%20Exclusion_files/8bc19c5640342f9c5ad0ba16baf59981.png">, and then busting all kinds of works of primes from the factorization.</p><p>Therefore we need a faster solution which calculates the responses for all numbers from the interval <img alt="[2;n]" class="tex" src="Inclusion%20Exclusion_files/844775997e9571036d4f38fb520ee6e8.png"> immediately.</p><p>To do this you implement such <b>a modification of the sieve of Eratosthenes</b>:</p><p></p><ul><p></p><li>First, we need to find all numbers in the interval <img alt="[2;n]" class="tex" src="Inclusion%20Exclusion_files/844775997e9571036d4f38fb520ee6e8.png">,
 no simple factorization which is not included twice. In addition, for 
the formula of inclusions-exceptions we need to know how contains a 
simple factorization of each number.<p>To do this we need to have an array <img alt="deg[]" class="tex" src="Inclusion%20Exclusion_files/d371fe7fd13b0d8c1a9a5a1b4a8be1ae.png">that stores for each number number in its factorization, and <img alt="good[]" class="tex" src="Inclusion%20Exclusion_files/30fdf40e66a148f515480b70d6201f55.png"> — contains for each number <img alt="true" class="tex" src="Inclusion%20Exclusion_files/b5bc0e4f62b03a6845c99fb75ef614c3.png"> , or <img alt="false" class="tex" src="Inclusion%20Exclusion_files/988fdf965f9fdcef08a01d4587277022.png"> — all simple enter it in extent <img alt="\le 1" class="tex" src="Inclusion%20Exclusion_files/b377390b983b51536621158e6cf14ba2.png"> or not.</p><p>After
 this, during the sieve of Eratosthenes when processing the next Prime 
number we go through all the numbers that are multiples of the current 
number, and increase <img alt="deg[]" class="tex" src="Inclusion%20Exclusion_files/d371fe7fd13b0d8c1a9a5a1b4a8be1ae.png"> they, and all numbers that are multiples of the square of the current simple — put <img alt="good = false" class="tex" src="Inclusion%20Exclusion_files/1a94163d09aec53db8aaab32cb2285b2.png">.</p><p></p></li><li>Secondly, we need to calculate the answer for all integers from <img alt="2" class="tex" src="Inclusion%20Exclusion_files/1f68ec6d6ed94148fc6fb5efafc8a688.png"> to <img alt="n" class="tex" src="Inclusion%20Exclusion_files/8bc19c5640342f9c5ad0ba16baf59981.png">, i.e., the array <img alt="cnt[]" class="tex" src="Inclusion%20Exclusion_files/d5c17179cdaf271a459893d92005bf78.png"> — the number of numbers that are not coprime with data.<p>To
 do this, recall how the formula of inclusions-exceptions — actually 
here we implement it, but with inverted logic: if we searched the term 
and look at the formula of inclusions-exceptions for numbers which this 
term enters.</p><p>So, let's say we have the number <img alt="i" class="tex" src="Inclusion%20Exclusion_files/2d9d1096e116db33bc39a0accf4e9ef7.png">for which <img alt="good[]=true" class="tex" src="Inclusion%20Exclusion_files/c36b38fdcaccc399541bfbc5f1dd1f9b.png">, i.e., the number involved in the formula of inclusions-exceptions. Iterate over all numbers that are multiples of <img alt="i" class="tex" src="Inclusion%20Exclusion_files/2d9d1096e116db33bc39a0accf4e9ef7.png">, and to answer <img alt="cnt[]" class="tex" src="Inclusion%20Exclusion_files/d5c17179cdaf271a459893d92005bf78.png"> each of these numbers we must add or subtract value <img alt="\lfloor N/i \rfloor" class="tex" src="Inclusion%20Exclusion_files/340ff6d98574d8ac0ea53397270a1098.png">. The sign is addition or subtraction depends on <img alt="deg[i]" class="tex" src="Inclusion%20Exclusion_files/c0ff09804666cfc13292e52da3aceabd.png">: if <img alt="deg[i]" class="tex" src="Inclusion%20Exclusion_files/c0ff09804666cfc13292e52da3aceabd.png"> is odd, then we need to add, otherwise subtract.</p><p></p></li></ul><p><b>Implementation</b>:</p><p></p><pre class="notranslate cpp"><span class="kw4">int</span> n<span class="sy4">;</span>
<span class="kw4">bool</span> good<span class="br0">[</span>MAXN<span class="br0">]</span><span class="sy4">;</span>
<span class="kw4">int</span> deg<span class="br0">[</span>MAXN<span class="br0">]</span>, cnt<span class="br0">[</span>MAXN<span class="br0">]</span><span class="sy4">;</span>
&nbsp;
<span class="kw4">long</span> <span class="kw4">long</span> solve<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
	<span class="kw3">memset</span> <span class="br0">(</span>good, <span class="nu0">1</span>, <span class="kw3">sizeof</span> good<span class="br0">)</span><span class="sy4">;</span>
	<span class="kw3">memset</span> <span class="br0">(</span>deg, <span class="nu0">0</span>, <span class="kw3">sizeof</span> deg<span class="br0">)</span><span class="sy4">;</span>
	<span class="kw3">memset</span> <span class="br0">(</span>cnt, <span class="nu0">0</span>, <span class="kw3">sizeof</span> cnt<span class="br0">)</span><span class="sy4">;</span>
&nbsp;
	<span class="kw4">long</span> <span class="kw4">long</span> ans_bad <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span>
	<span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> i<span class="sy1">=</span><span class="nu0">2</span><span class="sy4">;</span> i<span class="sy1">&lt;=</span>n<span class="sy4">;</span> <span class="sy2">++</span>i<span class="br0">)</span> <span class="br0">{</span>
		<span class="kw1">if</span> <span class="br0">(</span>good<span class="br0">[</span>i<span class="br0">]</span><span class="br0">)</span> <span class="br0">{</span>
			<span class="kw1">if</span> <span class="br0">(</span>deg<span class="br0">[</span>i<span class="br0">]</span> <span class="sy1">==</span> <span class="nu0">0</span><span class="br0">)</span> deg<span class="br0">[</span>i<span class="br0">]</span> <span class="sy1">=</span> <span class="nu0">1</span><span class="sy4">;</span>
			<span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> j<span class="sy1">=</span><span class="nu0">1</span><span class="sy4">;</span> i<span class="sy2">*</span>j<span class="sy1">&lt;=</span>n<span class="sy4">;</span> <span class="sy2">++</span>j<span class="br0">)</span> <span class="br0">{</span>
				<span class="kw1">if</span> <span class="br0">(</span>j <span class="sy1">&gt;</span> <span class="nu0">1</span> <span class="sy3">&amp;&amp;</span> deg<span class="br0">[</span>i<span class="br0">]</span> <span class="sy1">==</span> <span class="nu0">1</span><span class="br0">)</span>
					<span class="kw1">if</span> <span class="br0">(</span>j <span class="sy2">%</span> i <span class="sy1">==</span> <span class="nu0">0</span><span class="br0">)</span>
 good<span class="br0">[</span>i<span class="sy2">*</span>j<span class="br0">]</span> <span class="sy1">=</span> <span class="kw2">false</span><span class="sy4">;</span>
					<span class="kw1">else</span>
						<span class="sy2">++</span>deg<span class="br0">[</span>i<span class="sy2">*</span>j<span class="br0">]</span><span class="sy4">;</span>
 cnt<span class="br0">[</span>i<span class="sy2">*</span>j<span class="br0">]</span> <span class="sy2">+</span><span class="sy1">=</span> <span class="br0">(</span>n <span class="sy2">/</span> i<span class="br0">)</span> <span class="sy2">*</span> <span class="br0">(</span>deg<span class="br0">[</span>i<span class="br0">]</span><span class="sy2">%</span><span class="nu19">2</span><span class="sy1">==</span><span class="nu0">1</span> <span class="sy4">?</span> <span class="sy2">+</span><span class="nu0">1</span> <span class="sy4">:</span> <span class="sy2">-</span><span class="nu0">1</span><span class="br0">)</span><span class="sy4">;</span>
			<span class="br0">}</span>
		<span class="br0">}</span>
 ans_bad <span class="sy2">+</span><span class="sy1">=</span> <span class="br0">(</span>cnt<span class="br0">[</span>i<span class="br0">]</span> <span class="sy2">-</span> <span class="nu0">1</span><span class="br0">)</span> <span class="sy2">*</span> 1ll <span class="sy2">*</span> <span class="br0">(</span>n<span class="sy2">-</span><span class="nu0">1</span> <span class="sy2">-</span> cnt<span class="br0">[</span>i<span class="br0">]</span><span class="br0">)</span><span class="sy4">;</span>
	<span class="br0">}</span>
&nbsp;
	<span class="kw1">return</span> <span class="br0">(</span>n<span class="sy2">-</span><span class="nu0">1</span><span class="br0">)</span> <span class="sy2">*</span> 1ll <span class="sy2">*</span> <span class="br0">(</span>n<span class="sy2">-</span><span class="nu0">2</span><span class="br0">)</span> <span class="sy2">*</span> <span class="br0">(</span>n<span class="sy2">-</span><span class="nu0">3</span><span class="br0">)</span> <span class="sy2">/</span> <span class="nu0">6</span> <span class="sy2">-</span> ans_bad <span class="sy2">/</span> <span class="nu0">2</span><span class="sy4">;</span>
<span class="br0">}</span></pre><p>The asymptotics of such a solution is <img alt="O (n \log n)" class="tex" src="Inclusion%20Exclusion_files/65dae66ac82f684c5b24e464a8ca3610.png">because for almost every number <img alt="i" class="tex" src="Inclusion%20Exclusion_files/2d9d1096e116db33bc39a0accf4e9ef7.png"> it makes about <img alt="n/i" class="tex" src="Inclusion%20Exclusion_files/5e5d705b9ea3dd25f6dd5d22fbb6ae9d.png"> iterations of a nested loop.</p><p></p><p></p><h3 style="padding-top:15px;"> The number of permutations without fixed points </h3><p>Prove that the number of permutations of length <img alt="n" class="tex" src="Inclusion%20Exclusion_files/8bc19c5640342f9c5ad0ba16baf59981.png"> without fixed points is equal to the following number:</p><p></p><p class="formula"><img alt=" n! - C_n^1 \cdot (n-1)! + C_n^2 \cdot (n-2)! - C_[...]" class="tex" src="Inclusion%20Exclusion_files/a53f6e69914d9a937bc0c3e72906f6d0.png"></p><p>and approximately equal to the number:</p><p></p><p class="formula"><img alt=" \frac{ n! }{ e } " class="tex" src="Inclusion%20Exclusion_files/18ffcb43e2646f75f7cff8ba22b45938.png"></p><p>(moreover,
 if you round this expression to the nearest integer will produce the 
exact number of permutations without fixed points)</p><p>We denote <img alt="A_k" class="tex" src="Inclusion%20Exclusion_files/52475edaf8bceaddcd5bcedf63f73e80.png"> the set of permutations of length <img alt="n" class="tex" src="Inclusion%20Exclusion_files/8bc19c5640342f9c5ad0ba16baf59981.png"> with a fixed point at position <img alt="k" class="tex" src="Inclusion%20Exclusion_files/252410059470b019db6fd4c3b844a348.png"> (<img alt="1 \le k \le n" class="tex" src="Inclusion%20Exclusion_files/e97da6bafa3aeb5615fd72f4221245ca.png">).</p><p>Let
 us use now the formula of inclusions-exceptions to count the number of 
permutations with at least one xed point. To do this we need to learn to
 count sizes of sets-intersection <img alt="A_i" class="tex" src="Inclusion%20Exclusion_files/ecd1f057d6ceb5ed438e560f05b03792.png">, they are as follows:</p><p></p><p class="formula"><img alt=" \left| A_p \right| = (n-1)! ~, " class="tex" src="Inclusion%20Exclusion_files/9dad6e1702deffc228a8b13c2daf51d6.png"><br><img alt=" \left| A_p \cap A_q \right| = (n-2)! ~, " class="tex" src="Inclusion%20Exclusion_files/a55f5698e1945e73ad01819ada6c958b.png"><br><img alt=" \left| A_p \cap A_q \cap A_r \right| = (n-3)! ~, " class="tex" src="Inclusion%20Exclusion_files/90dcce063ccdb778e8e5c85855b8c8a1.png"><br><img alt=" \ldots ~, " class="tex" src="Inclusion%20Exclusion_files/0cd284d67610b3e6ab1651ef01610e73.png"></p><p>because if we know that the number of fixed points is equal <img alt="x" class="tex" src="Inclusion%20Exclusion_files/4a9252cee23f1a80a4e03256ef62d733.png">, thus we know the position <img alt="x" class="tex" src="Inclusion%20Exclusion_files/4a9252cee23f1a80a4e03256ef62d733.png"> of elements of the permutation, and all other <img alt="(n-x)" class="tex" src="Inclusion%20Exclusion_files/409090d19629d28ab15563b05d33c64d.png"> elements can stand anywhere.</p><p>Substituting this in the formula of inclusions-exceptions, and given that the number of ways to choose a subset of size <img alt="x" class="tex" src="Inclusion%20Exclusion_files/4a9252cee23f1a80a4e03256ef62d733.png"> from a <img alt="n" class="tex" src="Inclusion%20Exclusion_files/8bc19c5640342f9c5ad0ba16baf59981.png">-element set is equal to <img alt="C_n^x" class="tex" src="Inclusion%20Exclusion_files/efa6b7d0253437184649fa8c7d986f6c.png">, we get a formula for the number of permutations with at least one fixed point:</p><p></p><p class="formula"><img alt=" C_n^1 \cdot (n-1)! - C_n^2 \cdot (n-2)! + C_n^3 \[...]" class="tex" src="Inclusion%20Exclusion_files/e9fb4486c356cc70561a57a4c4d18c58.png"></p><p>Then the number of permutations without xed points is equal to:</p><p></p><p class="formula"><img alt=" n! - C_n^1 \cdot (n-1)! + C_n^2 \cdot (n-2)! - C_[...]" class="tex" src="Inclusion%20Exclusion_files/a53f6e69914d9a937bc0c3e72906f6d0.png"></p><p>Simplifying this expression, we obtain <b>exact and approximate expressions for the number of permutations without fixed points</b>:</p><p></p><p class="formula"><img alt=" n! \left( 1 - \frac{1}{1!} + \frac{1}{2!} - \frac[...]" class="tex" src="Inclusion%20Exclusion_files/f2586f8be08c6c5300e86c326074341e.png"></p><p>(because the sum in brackets are the first <img alt="n+1" class="tex" src="Inclusion%20Exclusion_files/a7f8de3dd9b0da0eb8ed96689169566e.png"> members of the decomposition in a Taylor series <img alt="e^{-1}" class="tex" src="Inclusion%20Exclusion_files/ca0ab31db3f57097d2d68b68b8fe04a7.png">)</p><p>In conclusion, it is worth noting that similarly solves the problem, when you want fixed points was not among <img alt="m" class="tex" src="Inclusion%20Exclusion_files/4f70748eaed5e0c2c70d7e899166ee1d.png">
 the first elements of permutations (and not among all, as we just 
solved). The formula will work the same as the above exact formula, only
 in it the money will go to <img alt="k" class="tex" src="Inclusion%20Exclusion_files/252410059470b019db6fd4c3b844a348.png">, and not before <img alt="n" class="tex" src="Inclusion%20Exclusion_files/8bc19c5640342f9c5ad0ba16baf59981.png">.</p><p></p><p></p><p></p><h2 style="padding-top:40px;"> Problem in online judges </h2><p>The list of tasks that can be solved by using the principle of inclusions-exceptions:</p><p></p><ul><p></p><li><a href="https://z5h64q92x9.net/proxy_u/ru-en.en/uva.onlinejudge.org/index.php?option=onlinejudge&amp;page=show_problem&amp;problem=1266">UVA #10325 <b>"The Lottery"</b> [difficulty: easy]</a><p></p></li><li><a href="https://z5h64q92x9.net/proxy_u/ru-en.en/uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;problem=2906">UVA #11806 <b>"Cheerleaders"</b> [difficulty: easy]</a><p></p></li><li><a href="https://z5h64q92x9.net/proxy_u/ru-en.en/www.topcoder.com/stat?c=problem_statement&amp;pm=10875">TopCoder SRM 477 <b>"CarelessSecretary"</b> [difficulty: easy]</a><p></p></li><li><a href="https://z5h64q92x9.net/proxy_u/ru-en.en/community.topcoder.com/stat?c=problem_statement&amp;pm=6658&amp;rd=10068">TopCoder TCHS 16 <b>"Divisibility"</b> [difficulty: easy]</a><p></p></li><li><a href="https://z5h64q92x9.net/proxy_u/ru-en.en/www.spoj.pl/problems/NGM2/">SPOJ #6285 NGM2 <b>"Another Game With Numbers"</b> [difficulty: easy]</a><p></p></li><li><a href="https://z5h64q92x9.net/proxy_u/ru-en.en/community.topcoder.com/stat?c=problem_statement&amp;pm=8470">TopCoder SRM 382 <b>"CharmingTicketsEasy"</b> [difficulty: medium]</a><p></p></li><li><a href="https://z5h64q92x9.net/proxy_u/ru-en.en/www.topcoder.com/stat?c=problem_statement&amp;pm=8307">TopCoder SRM 390 <b>"SetOfPatterns"</b> [difficulty: medium]</a><p></p></li><li><a href="https://z5h64q92x9.net/proxy_u/ru-en.en/community.topcoder.com/stat?c=problem_statement&amp;pm=2013">TopCoder SRM 176 <b>"Deranged"</b> [difficulty: medium]</a><p></p></li><li><a href="https://z5h64q92x9.net/proxy_u/ru-en.en/community.topcoder.com/stat?c=problem_statement&amp;pm=10702&amp;rd=14144&amp;rm=303184&amp;cr=22697599">TopCoder SRM 457 <b>"TheHexagonsDivOne"</b> [difficulty: medium]</a><p></p></li><li><a href="https://z5h64q92x9.net/proxy_u/ru-en.en/www.spoj.pl/problems/MSKYCODE/">SPOJ #4191 MSKYCODE <b>"Sky Code"</b> [difficulty: medium]</a><p></p></li><li><a href="https://z5h64q92x9.net/proxy_u/ru-en.en/www.spoj.pl/problems/SQFREE/">SPOJ #4168 SQFREE <b>"Square-free integers"</b> [difficulty: medium]</a><p></p></li><li><a href="https://z5h64q92x9.net/proxy_u/ru-en.en/www.codechef.com/JAN11/problems/COUNTREL/">CodeChef <b>"Count Relations"</b> [difficulty: medium]</a><p></p></li></ul><p></p><p></p><p></p><h2 style="padding-top:40px;"> Literature </h2><p></p><ul><p></p><li><a href="https://z5h64q92x9.net/proxy_u/ru-en.en/faculty.wheelock.edu/dborkovitz/articles/ngm6.htm">Debra K. Borkovitz. <b>"The Derangements and Inclusion-Exclusion Principle"</b></a><p></p></li></ul><p></p><p></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
</p><div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></tbody></table>
<script type="text/javascript">
            (function (win, doc, namespace) {
                var trDir = namespace.trDir.split('-');
                if (doc.querySelector('meta[content^="yandex-pdf2html"]')) {
                    namespace.config.filters = [
                        function removeHyphenation(chunks) {
                            var i, j, n, m, k, span, next, value, spans;
                            for (i = 0, n = chunks.length; i < n; i++) {
                                spans = chunks[i].getSpans();
                                for (j = 0, m = spans.length; j < m; j++) {
                                    span = spans[j];
                                    next = spans[j + 1];
                                    value = span.getParam('value');
                                    k = value.search(/\S+\-$/);
                                    if (k >= 0 && next) {
                                        span.setParam('value', value.slice(0, k));
                                        next.setParam('value', value.slice(k, -1) + next.getParam('value'));
                                    }
                                }
                            }
                        }
                    ];
                }
                if (win.top === win) {
                    win.setTimeout(function () {
                        var translator = new namespace.PageTranslator(namespace.config);
                        translator.translate(trDir[0], trDir[1]);
                    }, 1000);
                }
            })(this, this.document, this.yt = this.yt || {});
        </script>
</body></html>